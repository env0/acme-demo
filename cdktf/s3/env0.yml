version: 1

deploy:
  steps:
    setupVariables: &cf
      after: 
        - |
          alias terraform='opentofu'
          sudo npm install -g cdktf-cli@latest
          npm install
          cdktf list
          cdktf synth
          cp cdktf.out/stacks/s3/* .
          cat cdk.tf.json

destroy:
  steps:
    setupVariables: *cf
