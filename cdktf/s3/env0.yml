version: 1

deploy:
  steps:
    terraformInit: &cf
      before: 
        - |
          alias terraform='opentofu'
          alias tfenv='tofuenv'
          sudo npm install -g cdktf-cli@latest
          npm install
          cdktf list
          cdktf synth
          cp cdktf.out/stacks/s3/* .
          cat cdk.tf.json

destroy:
  steps:
    terraformInit: *cf
