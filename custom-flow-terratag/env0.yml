version: 2

deploy:
  steps:
    terraformInit:
      before:
        - name: Generate Custom Tags JSON
          run: |
            JSON_TAGS=$(jq -n \
              --arg firstKey "$firstKey" \
              --arg secondKey "$secondKey" \
              --arg dropDownValue "$dropDownValue" \
              '{firstKey: $firstKey, secondKey: $secondKey, dropDownValue: $dropDownValue}')
            echo ENV0_CUSTOM_TAGS=$JSON_TAGS >> $ENV0_ENV

      after:
        - name: Print the custom tags after init
          run: |
            echo "Custom tags:"
            echo $ENV0_CUSTOM_TAGS